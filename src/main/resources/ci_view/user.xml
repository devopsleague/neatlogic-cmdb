<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Copyright(c) 2021 TechSure Co., Ltd. All Rights Reserved.
  ~ 本内容仅限于深圳市赞悦科技有限公司内部传阅，禁止外泄以及用于其他的商业项目。
  -->

<view>
    <ci id="user">
        <attrs>
            <attr column="ci_id"
            <attr column="user_id" label="用户id"></attr>
            <attr column="user_name" label="用户名"></attr>
            <attr column="email" label="邮件"></attr>
            <attr column="phone" label="电话"></attr>
            <attr column="pinyin" label="拼音"></attr>
        </attrs>
        <sql>
            SELECT
            `u`.`id` AS id,
            `u`.`user_name` AS name,
            `u`.`user_id`,
            `u`.`user_name`,
            group_concat( `t`.`name` SEPARATOR ',' )
            FROM
            `user` `u`
            LEFT JOIN `user_team` `ut` ON `u`.`uuid` = `ut`.`user_uuid`
            LEFT JOIN `team` `t` ON `t`.`uuid` = `ut`.`team_uuid`
            GROUP BY
            `u`.`id`
        </sql>
    </ci>
</view>